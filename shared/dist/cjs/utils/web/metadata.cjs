"use strict";function t(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}function e(t){if(t&&t.__esModule)return t;var e=Object.create(null);return t&&Object.keys(t).forEach((function(r){if("default"!==r){var n=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(e,r,n.get?n:{enumerable:!0,get:function(){return t[r]}})}})),e.default=t,Object.freeze(e)}Object.defineProperty(exports,"__esModule",{value:!0});var r=t(require("cheerio"));let n;async function a(t){try{n||(n=await Promise.resolve().then((function(){return e(require("node-fetch"))})));const a=n.default,o=await a(t);if(!o.ok)throw new Error(`Failed to fetch URL: ${o.status}`);const c=await o.text(),i=r.default.load(c),s={title:"",description:"",author:"",date:"",source:t,site:"",captured:(new Date).toISOString()};s.title=i('meta[property="og:title"]').attr("content")||i('meta[name="twitter:title"]').attr("content")||i("title").text()||new URL(t).hostname,s.description=i('meta[property="og:description"]').attr("content")||i('meta[name="description"]').attr("content")||i('meta[name="twitter:description"]').attr("content")||"",s.author=i('meta[name="author"]').attr("content")||i('meta[property="article:author"]').attr("content")||"",s.date=i('meta[property="article:published_time"]').attr("content")||i('meta[name="publication_date"]').attr("content")||"",s.site=i('meta[property="og:site_name"]').attr("content")||new URL(t).hostname,s.images=[i('meta[property="og:image"]').attr("content"),i('meta[name="twitter:image"]').attr("content")].filter(Boolean);const u=i('meta[name="keywords"]').attr("content");return u&&(s.keywords=u.split(",").map((t=>t.trim()))),function(t){const e={};return Object.entries(t).forEach((([t,r])=>{if("string"==typeof r){const n=r.trim();n&&(e[t]=n)}else Array.isArray(r)?r.length>0&&(e[t]=r.filter(Boolean)):null!=r&&(e[t]=r)})),e}(s)}catch(e){return console.error("Metadata extraction error:",e),{title:new URL(t).hostname,source:t,captured:(new Date).toISOString()}}}function o(t){try{const e=r.default.load(t);e("script, style, meta, link, noscript").remove();let n=e("article").text()||e("main").text();return n||(n=e(".content, .post-content, .entry-content").text()),n||(n=e("body").text()),n.replace(/\s+/g," ").replace(/\n+/g,"\n\n").trim()}catch(t){return console.error("Content extraction error:",t),""}}async function c(t,e){try{const n=r.default.load(t),a=[],o=new Set;return n("a[href]").each(((t,r)=>{const c=n(r),i=c.attr("href");if(i)try{const t=new URL(i,e).href;!o.has(t)&&t.match(/^https?:\/\//)&&(o.add(t),a.push({url:t,text:c.text().trim()}))}catch(t){}})),a}catch(t){return console.error("Link extraction error:",t),[]}}var i={extractMetadata:a,extractContent:o,extractLinks:c};exports.default=i,exports.extractContent=o,exports.extractLinks=c,exports.extractMetadata=a;
