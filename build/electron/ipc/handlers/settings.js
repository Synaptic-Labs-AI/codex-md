"use strict";

/**
 * Settings IPC Handlers
 * Provides handlers for settings-related IPC operations.
 * 
 * Related files:
 * - preload.js: Exposes these handlers to the renderer
 * - main.js: Registers these handlers
 */

const {
  ipcMain
} = require('electron');
const {
  createStore
} = require('../../utils/storeFactory');

// Create a store for settings
const settingsStore = createStore('settings', {
  encryptionKey: process.env.STORE_ENCRYPTION_KEY
});

// Default settings
const DEFAULT_SETTINGS = {
  ocr: {
    enabled: false
  },
  transcription: {
    model: 'whisper'
  }
};

// Register handlers
function registerHandlers() {
  // Get a setting
  ipcMain.handle('codex:get-setting', async (event, key) => {
    try {
      const parts = key.split('.');
      let value = settingsStore.get(parts[0], DEFAULT_SETTINGS[parts[0]]);

      // Navigate through nested properties
      for (let i = 1; i < parts.length; i++) {
        if (value === undefined || value === null) return undefined;
        value = value[parts[i]];
      }
      return value;
    } catch (error) {
      console.error(`Error getting setting ${key}:`, error);
      return undefined;
    }
  });

  // Set a setting
  ipcMain.handle('codex:set-setting', async (event, key, value) => {
    try {
      console.log(`[Settings Handler] Setting ${key} to: ${value} (type: ${typeof value})`);

      // Log current store value
      const currentValue = settingsStore.get(key);
      console.log(`[Settings Handler] Current value of ${key}: ${currentValue} (type: ${typeof currentValue})`);
      const parts = key.split('.');
      if (parts.length === 1) {
        // Top-level setting
        console.log(`[Settings Handler] Setting top-level setting ${key}`);
        settingsStore.set(key, value);
      } else {
        // Nested setting
        console.log(`[Settings Handler] Setting nested setting ${key}`);
        const topLevel = parts[0];
        const current = settingsStore.get(topLevel, {});
        console.log(`[Settings Handler] Current top-level object:`, current);

        // Navigate to the right nesting level
        let target = current;
        for (let i = 1; i < parts.length - 1; i++) {
          if (!target[parts[i]]) {
            console.log(`[Settings Handler] Creating nested object at ${parts.slice(0, i + 1).join('.')}`);
            target[parts[i]] = {};
          }
          target = target[parts[i]];
        }

        // Set the value
        const lastKey = parts[parts.length - 1];
        const oldValue = target[lastKey];
        target[lastKey] = value;
        console.log(`[Settings Handler] Updated ${key} from ${oldValue} to ${value}`);
        settingsStore.set(topLevel, current);
      }

      // Verify the setting was saved
      const savedValue = settingsStore.get(key);
      console.log(`[Settings Handler] Successfully set ${key} to: ${savedValue} (type: ${typeof savedValue})`);
      return {
        success: true
      };
    } catch (error) {
      console.error(`Error setting ${key}:`, error);
      return {
        success: false,
        error: error.message
      };
    }
  });

  // OCR specific handlers
  ipcMain.handle('codex:settings:get-ocr-enabled', async () => {
    // Check both ways of accessing the setting
    const nestedEnabled = settingsStore.get('ocr.enabled', DEFAULT_SETTINGS.ocr.enabled);
    const ocr = settingsStore.get('ocr', DEFAULT_SETTINGS.ocr);
    const directEnabled = ocr.enabled;
    console.log('🔍 [Settings] Get OCR enabled (nested):', nestedEnabled, `(type: ${typeof nestedEnabled})`);
    console.log('🔍 [Settings] Get OCR enabled (direct):', directEnabled, `(type: ${typeof directEnabled})`);
    console.log('🔍 [Settings] Full OCR object:', ocr);
    return nestedEnabled;
  });
  ipcMain.handle('codex:settings:get-ocr-enabled-direct', async () => {
    const enabled = settingsStore.get('ocr.enabled', DEFAULT_SETTINGS.ocr.enabled);
    console.log('🔍 [Settings] Get OCR enabled (direct):', enabled, `(type: ${typeof enabled})`);

    // Also check the raw store data
    const rawData = settingsStore.store;
    console.log('🔍 [Settings] Raw store data:', rawData);
    return enabled;
  });
  ipcMain.handle('codex:settings:set-ocr-enabled', async (event, {
    enabled
  }) => {
    try {
      console.log(`[Settings] Set OCR enabled called with:`, enabled, `(type: ${typeof enabled})`);

      // Ensure enabled is a boolean
      const boolEnabled = Boolean(enabled);
      console.log(`[Settings] Converted to boolean: ${boolEnabled} (type: ${typeof boolEnabled})`);

      // Get current value for comparison
      const currentOcr = settingsStore.get('ocr', DEFAULT_SETTINGS.ocr);
      console.log(`[Settings] Current OCR settings:`, currentOcr);

      // Update the setting
      const ocr = {
        ...currentOcr
      };
      const oldValue = ocr.enabled;
      ocr.enabled = boolEnabled;
      console.log(`[Settings] Updating OCR enabled from ${oldValue} to ${boolEnabled}`);

      // Save to store
      settingsStore.set('ocr', ocr);

      // Verify the setting was saved
      const savedOcr = settingsStore.get('ocr');
      console.log(`[Settings] Saved OCR settings:`, savedOcr);
      console.log(`[Settings] Verified OCR enabled is now: ${savedOcr.enabled} (type: ${typeof savedOcr.enabled})`);

      // Double-check that the value was saved correctly
      if (savedOcr.enabled !== boolEnabled) {
        console.warn(`[Settings] Warning: Saved value (${savedOcr.enabled}) doesn't match requested value (${boolEnabled}). Attempting to fix...`);

        // Try setting directly with the dot notation
        settingsStore.set('ocr.enabled', boolEnabled);

        // Verify again
        const recheck = settingsStore.get('ocr');
        console.log(`[Settings] After fix attempt, OCR enabled is: ${recheck.enabled} (type: ${typeof recheck.enabled})`);
      }
      return {
        success: true,
        value: savedOcr.enabled
      };
    } catch (error) {
      console.error('Error setting OCR enabled:', error);
      return {
        success: false,
        error: error.message
      };
    }
  });
}
/**
 * Get a setting value directly (for use by other modules)
 * @param {string} key - The setting key
 * @param {any} defaultValue - Default value if setting not found
 * @returns {any} The setting value
 */
function getSettingValue(key, defaultValue) {
  try {
    const parts = key.split('.');
    let value = settingsStore.get(parts[0], DEFAULT_SETTINGS[parts[0]]);

    // Navigate through nested properties
    for (let i = 1; i < parts.length; i++) {
      if (value === undefined || value === null) return defaultValue;
      value = value[parts[i]];
    }
    return value !== undefined ? value : defaultValue;
  } catch (error) {
    console.error(`Error getting setting ${key}:`, error);
    return defaultValue;
  }
}
module.exports = {
  registerHandlers,
  getSettingValue
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJpcGNNYWluIiwicmVxdWlyZSIsImNyZWF0ZVN0b3JlIiwic2V0dGluZ3NTdG9yZSIsImVuY3J5cHRpb25LZXkiLCJwcm9jZXNzIiwiZW52IiwiU1RPUkVfRU5DUllQVElPTl9LRVkiLCJERUZBVUxUX1NFVFRJTkdTIiwib2NyIiwiZW5hYmxlZCIsInRyYW5zY3JpcHRpb24iLCJtb2RlbCIsInJlZ2lzdGVySGFuZGxlcnMiLCJoYW5kbGUiLCJldmVudCIsImtleSIsInBhcnRzIiwic3BsaXQiLCJ2YWx1ZSIsImdldCIsImkiLCJsZW5ndGgiLCJ1bmRlZmluZWQiLCJlcnJvciIsImNvbnNvbGUiLCJsb2ciLCJjdXJyZW50VmFsdWUiLCJzZXQiLCJ0b3BMZXZlbCIsImN1cnJlbnQiLCJ0YXJnZXQiLCJzbGljZSIsImpvaW4iLCJsYXN0S2V5Iiwib2xkVmFsdWUiLCJzYXZlZFZhbHVlIiwic3VjY2VzcyIsIm1lc3NhZ2UiLCJuZXN0ZWRFbmFibGVkIiwiZGlyZWN0RW5hYmxlZCIsInJhd0RhdGEiLCJzdG9yZSIsImJvb2xFbmFibGVkIiwiQm9vbGVhbiIsImN1cnJlbnRPY3IiLCJzYXZlZE9jciIsIndhcm4iLCJyZWNoZWNrIiwiZ2V0U2V0dGluZ1ZhbHVlIiwiZGVmYXVsdFZhbHVlIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9lbGVjdHJvbi9pcGMvaGFuZGxlcnMvc2V0dGluZ3MuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIFNldHRpbmdzIElQQyBIYW5kbGVyc1xyXG4gKiBQcm92aWRlcyBoYW5kbGVycyBmb3Igc2V0dGluZ3MtcmVsYXRlZCBJUEMgb3BlcmF0aW9ucy5cclxuICogXHJcbiAqIFJlbGF0ZWQgZmlsZXM6XHJcbiAqIC0gcHJlbG9hZC5qczogRXhwb3NlcyB0aGVzZSBoYW5kbGVycyB0byB0aGUgcmVuZGVyZXJcclxuICogLSBtYWluLmpzOiBSZWdpc3RlcnMgdGhlc2UgaGFuZGxlcnNcclxuICovXHJcblxyXG5jb25zdCB7IGlwY01haW4gfSA9IHJlcXVpcmUoJ2VsZWN0cm9uJyk7XHJcbmNvbnN0IHsgY3JlYXRlU3RvcmUgfSA9IHJlcXVpcmUoJy4uLy4uL3V0aWxzL3N0b3JlRmFjdG9yeScpO1xyXG5cclxuLy8gQ3JlYXRlIGEgc3RvcmUgZm9yIHNldHRpbmdzXHJcbmNvbnN0IHNldHRpbmdzU3RvcmUgPSBjcmVhdGVTdG9yZSgnc2V0dGluZ3MnLCB7XHJcbiAgZW5jcnlwdGlvbktleTogcHJvY2Vzcy5lbnYuU1RPUkVfRU5DUllQVElPTl9LRVlcclxufSk7XHJcblxyXG4vLyBEZWZhdWx0IHNldHRpbmdzXHJcbmNvbnN0IERFRkFVTFRfU0VUVElOR1MgPSB7XHJcbiAgb2NyOiB7XHJcbiAgICBlbmFibGVkOiBmYWxzZVxyXG4gIH0sXHJcbiAgdHJhbnNjcmlwdGlvbjoge1xyXG4gICAgbW9kZWw6ICd3aGlzcGVyJ1xyXG4gIH1cclxufTtcclxuXHJcbi8vIFJlZ2lzdGVyIGhhbmRsZXJzXHJcbmZ1bmN0aW9uIHJlZ2lzdGVySGFuZGxlcnMoKSB7XHJcbiAgLy8gR2V0IGEgc2V0dGluZ1xyXG4gIGlwY01haW4uaGFuZGxlKCdjb2RleDpnZXQtc2V0dGluZycsIGFzeW5jIChldmVudCwga2V5KSA9PiB7XHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCBwYXJ0cyA9IGtleS5zcGxpdCgnLicpO1xyXG4gICAgICBsZXQgdmFsdWUgPSBzZXR0aW5nc1N0b3JlLmdldChwYXJ0c1swXSwgREVGQVVMVF9TRVRUSU5HU1twYXJ0c1swXV0pO1xyXG4gICAgICBcclxuICAgICAgLy8gTmF2aWdhdGUgdGhyb3VnaCBuZXN0ZWQgcHJvcGVydGllc1xyXG4gICAgICBmb3IgKGxldCBpID0gMTsgaSA8IHBhcnRzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgaWYgKHZhbHVlID09PSB1bmRlZmluZWQgfHwgdmFsdWUgPT09IG51bGwpIHJldHVybiB1bmRlZmluZWQ7XHJcbiAgICAgICAgdmFsdWUgPSB2YWx1ZVtwYXJ0c1tpXV07XHJcbiAgICAgIH1cclxuICAgICAgXHJcbiAgICAgIHJldHVybiB2YWx1ZTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoYEVycm9yIGdldHRpbmcgc2V0dGluZyAke2tleX06YCwgZXJyb3IpO1xyXG4gICAgICByZXR1cm4gdW5kZWZpbmVkO1xyXG4gICAgfVxyXG4gIH0pO1xyXG5cclxuICAvLyBTZXQgYSBzZXR0aW5nXHJcbiAgaXBjTWFpbi5oYW5kbGUoJ2NvZGV4OnNldC1zZXR0aW5nJywgYXN5bmMgKGV2ZW50LCBrZXksIHZhbHVlKSA9PiB7XHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zb2xlLmxvZyhgW1NldHRpbmdzIEhhbmRsZXJdIFNldHRpbmcgJHtrZXl9IHRvOiAke3ZhbHVlfSAodHlwZTogJHt0eXBlb2YgdmFsdWV9KWApO1xyXG4gICAgICBcclxuICAgICAgLy8gTG9nIGN1cnJlbnQgc3RvcmUgdmFsdWVcclxuICAgICAgY29uc3QgY3VycmVudFZhbHVlID0gc2V0dGluZ3NTdG9yZS5nZXQoa2V5KTtcclxuICAgICAgY29uc29sZS5sb2coYFtTZXR0aW5ncyBIYW5kbGVyXSBDdXJyZW50IHZhbHVlIG9mICR7a2V5fTogJHtjdXJyZW50VmFsdWV9ICh0eXBlOiAke3R5cGVvZiBjdXJyZW50VmFsdWV9KWApO1xyXG4gICAgICBcclxuICAgICAgY29uc3QgcGFydHMgPSBrZXkuc3BsaXQoJy4nKTtcclxuICAgICAgXHJcbiAgICAgIGlmIChwYXJ0cy5sZW5ndGggPT09IDEpIHtcclxuICAgICAgICAvLyBUb3AtbGV2ZWwgc2V0dGluZ1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGBbU2V0dGluZ3MgSGFuZGxlcl0gU2V0dGluZyB0b3AtbGV2ZWwgc2V0dGluZyAke2tleX1gKTtcclxuICAgICAgICBzZXR0aW5nc1N0b3JlLnNldChrZXksIHZhbHVlKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICAvLyBOZXN0ZWQgc2V0dGluZ1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGBbU2V0dGluZ3MgSGFuZGxlcl0gU2V0dGluZyBuZXN0ZWQgc2V0dGluZyAke2tleX1gKTtcclxuICAgICAgICBjb25zdCB0b3BMZXZlbCA9IHBhcnRzWzBdO1xyXG4gICAgICAgIGNvbnN0IGN1cnJlbnQgPSBzZXR0aW5nc1N0b3JlLmdldCh0b3BMZXZlbCwge30pO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGBbU2V0dGluZ3MgSGFuZGxlcl0gQ3VycmVudCB0b3AtbGV2ZWwgb2JqZWN0OmAsIGN1cnJlbnQpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIE5hdmlnYXRlIHRvIHRoZSByaWdodCBuZXN0aW5nIGxldmVsXHJcbiAgICAgICAgbGV0IHRhcmdldCA9IGN1cnJlbnQ7XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDE7IGkgPCBwYXJ0cy5sZW5ndGggLSAxOyBpKyspIHtcclxuICAgICAgICAgIGlmICghdGFyZ2V0W3BhcnRzW2ldXSkge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhgW1NldHRpbmdzIEhhbmRsZXJdIENyZWF0aW5nIG5lc3RlZCBvYmplY3QgYXQgJHtwYXJ0cy5zbGljZSgwLCBpKzEpLmpvaW4oJy4nKX1gKTtcclxuICAgICAgICAgICAgdGFyZ2V0W3BhcnRzW2ldXSA9IHt9O1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgdGFyZ2V0ID0gdGFyZ2V0W3BhcnRzW2ldXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gU2V0IHRoZSB2YWx1ZVxyXG4gICAgICAgIGNvbnN0IGxhc3RLZXkgPSBwYXJ0c1twYXJ0cy5sZW5ndGggLSAxXTtcclxuICAgICAgICBjb25zdCBvbGRWYWx1ZSA9IHRhcmdldFtsYXN0S2V5XTtcclxuICAgICAgICB0YXJnZXRbbGFzdEtleV0gPSB2YWx1ZTtcclxuICAgICAgICBjb25zb2xlLmxvZyhgW1NldHRpbmdzIEhhbmRsZXJdIFVwZGF0ZWQgJHtrZXl9IGZyb20gJHtvbGRWYWx1ZX0gdG8gJHt2YWx1ZX1gKTtcclxuICAgICAgICBcclxuICAgICAgICBzZXR0aW5nc1N0b3JlLnNldCh0b3BMZXZlbCwgY3VycmVudCk7XHJcbiAgICAgIH1cclxuICAgICAgXHJcbiAgICAgIC8vIFZlcmlmeSB0aGUgc2V0dGluZyB3YXMgc2F2ZWRcclxuICAgICAgY29uc3Qgc2F2ZWRWYWx1ZSA9IHNldHRpbmdzU3RvcmUuZ2V0KGtleSk7XHJcbiAgICAgIGNvbnNvbGUubG9nKGBbU2V0dGluZ3MgSGFuZGxlcl0gU3VjY2Vzc2Z1bGx5IHNldCAke2tleX0gdG86ICR7c2F2ZWRWYWx1ZX0gKHR5cGU6ICR7dHlwZW9mIHNhdmVkVmFsdWV9KWApO1xyXG4gICAgICBcclxuICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcihgRXJyb3Igc2V0dGluZyAke2tleX06YCwgZXJyb3IpO1xyXG4gICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxuICB9KTtcclxuXHJcbiAgLy8gT0NSIHNwZWNpZmljIGhhbmRsZXJzXHJcbiAgaXBjTWFpbi5oYW5kbGUoJ2NvZGV4OnNldHRpbmdzOmdldC1vY3ItZW5hYmxlZCcsIGFzeW5jICgpID0+IHtcclxuICAgIC8vIENoZWNrIGJvdGggd2F5cyBvZiBhY2Nlc3NpbmcgdGhlIHNldHRpbmdcclxuICAgIGNvbnN0IG5lc3RlZEVuYWJsZWQgPSBzZXR0aW5nc1N0b3JlLmdldCgnb2NyLmVuYWJsZWQnLCBERUZBVUxUX1NFVFRJTkdTLm9jci5lbmFibGVkKTtcclxuICAgIGNvbnN0IG9jciA9IHNldHRpbmdzU3RvcmUuZ2V0KCdvY3InLCBERUZBVUxUX1NFVFRJTkdTLm9jcik7XHJcbiAgICBjb25zdCBkaXJlY3RFbmFibGVkID0gb2NyLmVuYWJsZWQ7XHJcbiAgICBcclxuICAgIGNvbnNvbGUubG9nKCfwn5SNIFtTZXR0aW5nc10gR2V0IE9DUiBlbmFibGVkIChuZXN0ZWQpOicsIG5lc3RlZEVuYWJsZWQsIGAodHlwZTogJHt0eXBlb2YgbmVzdGVkRW5hYmxlZH0pYCk7XHJcbiAgICBjb25zb2xlLmxvZygn8J+UjSBbU2V0dGluZ3NdIEdldCBPQ1IgZW5hYmxlZCAoZGlyZWN0KTonLCBkaXJlY3RFbmFibGVkLCBgKHR5cGU6ICR7dHlwZW9mIGRpcmVjdEVuYWJsZWR9KWApO1xyXG4gICAgY29uc29sZS5sb2coJ/CflI0gW1NldHRpbmdzXSBGdWxsIE9DUiBvYmplY3Q6Jywgb2NyKTtcclxuICAgIFxyXG4gICAgcmV0dXJuIG5lc3RlZEVuYWJsZWQ7XHJcbiAgfSk7XHJcbiAgXHJcbiAgaXBjTWFpbi5oYW5kbGUoJ2NvZGV4OnNldHRpbmdzOmdldC1vY3ItZW5hYmxlZC1kaXJlY3QnLCBhc3luYyAoKSA9PiB7XHJcbiAgICBjb25zdCBlbmFibGVkID0gc2V0dGluZ3NTdG9yZS5nZXQoJ29jci5lbmFibGVkJywgREVGQVVMVF9TRVRUSU5HUy5vY3IuZW5hYmxlZCk7XHJcbiAgICBjb25zb2xlLmxvZygn8J+UjSBbU2V0dGluZ3NdIEdldCBPQ1IgZW5hYmxlZCAoZGlyZWN0KTonLCBlbmFibGVkLCBgKHR5cGU6ICR7dHlwZW9mIGVuYWJsZWR9KWApO1xyXG4gICAgXHJcbiAgICAvLyBBbHNvIGNoZWNrIHRoZSByYXcgc3RvcmUgZGF0YVxyXG4gICAgY29uc3QgcmF3RGF0YSA9IHNldHRpbmdzU3RvcmUuc3RvcmU7XHJcbiAgICBjb25zb2xlLmxvZygn8J+UjSBbU2V0dGluZ3NdIFJhdyBzdG9yZSBkYXRhOicsIHJhd0RhdGEpO1xyXG4gICAgXHJcbiAgICByZXR1cm4gZW5hYmxlZDtcclxuICB9KTtcclxuXHJcbiAgaXBjTWFpbi5oYW5kbGUoJ2NvZGV4OnNldHRpbmdzOnNldC1vY3ItZW5hYmxlZCcsIGFzeW5jIChldmVudCwgeyBlbmFibGVkIH0pID0+IHtcclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKGBbU2V0dGluZ3NdIFNldCBPQ1IgZW5hYmxlZCBjYWxsZWQgd2l0aDpgLCBlbmFibGVkLCBgKHR5cGU6ICR7dHlwZW9mIGVuYWJsZWR9KWApO1xyXG4gICAgICBcclxuICAgICAgLy8gRW5zdXJlIGVuYWJsZWQgaXMgYSBib29sZWFuXHJcbiAgICAgIGNvbnN0IGJvb2xFbmFibGVkID0gQm9vbGVhbihlbmFibGVkKTtcclxuICAgICAgY29uc29sZS5sb2coYFtTZXR0aW5nc10gQ29udmVydGVkIHRvIGJvb2xlYW46ICR7Ym9vbEVuYWJsZWR9ICh0eXBlOiAke3R5cGVvZiBib29sRW5hYmxlZH0pYCk7XHJcbiAgICAgIFxyXG4gICAgICAvLyBHZXQgY3VycmVudCB2YWx1ZSBmb3IgY29tcGFyaXNvblxyXG4gICAgICBjb25zdCBjdXJyZW50T2NyID0gc2V0dGluZ3NTdG9yZS5nZXQoJ29jcicsIERFRkFVTFRfU0VUVElOR1Mub2NyKTtcclxuICAgICAgY29uc29sZS5sb2coYFtTZXR0aW5nc10gQ3VycmVudCBPQ1Igc2V0dGluZ3M6YCwgY3VycmVudE9jcik7XHJcbiAgICAgIFxyXG4gICAgICAvLyBVcGRhdGUgdGhlIHNldHRpbmdcclxuICAgICAgY29uc3Qgb2NyID0gey4uLmN1cnJlbnRPY3J9O1xyXG4gICAgICBjb25zdCBvbGRWYWx1ZSA9IG9jci5lbmFibGVkO1xyXG4gICAgICBvY3IuZW5hYmxlZCA9IGJvb2xFbmFibGVkO1xyXG4gICAgICBjb25zb2xlLmxvZyhgW1NldHRpbmdzXSBVcGRhdGluZyBPQ1IgZW5hYmxlZCBmcm9tICR7b2xkVmFsdWV9IHRvICR7Ym9vbEVuYWJsZWR9YCk7XHJcbiAgICAgIFxyXG4gICAgICAvLyBTYXZlIHRvIHN0b3JlXHJcbiAgICAgIHNldHRpbmdzU3RvcmUuc2V0KCdvY3InLCBvY3IpO1xyXG4gICAgICBcclxuICAgICAgLy8gVmVyaWZ5IHRoZSBzZXR0aW5nIHdhcyBzYXZlZFxyXG4gICAgICBjb25zdCBzYXZlZE9jciA9IHNldHRpbmdzU3RvcmUuZ2V0KCdvY3InKTtcclxuICAgICAgY29uc29sZS5sb2coYFtTZXR0aW5nc10gU2F2ZWQgT0NSIHNldHRpbmdzOmAsIHNhdmVkT2NyKTtcclxuICAgICAgY29uc29sZS5sb2coYFtTZXR0aW5nc10gVmVyaWZpZWQgT0NSIGVuYWJsZWQgaXMgbm93OiAke3NhdmVkT2NyLmVuYWJsZWR9ICh0eXBlOiAke3R5cGVvZiBzYXZlZE9jci5lbmFibGVkfSlgKTtcclxuICAgICAgXHJcbiAgICAgIC8vIERvdWJsZS1jaGVjayB0aGF0IHRoZSB2YWx1ZSB3YXMgc2F2ZWQgY29ycmVjdGx5XHJcbiAgICAgIGlmIChzYXZlZE9jci5lbmFibGVkICE9PSBib29sRW5hYmxlZCkge1xyXG4gICAgICAgIGNvbnNvbGUud2FybihgW1NldHRpbmdzXSBXYXJuaW5nOiBTYXZlZCB2YWx1ZSAoJHtzYXZlZE9jci5lbmFibGVkfSkgZG9lc24ndCBtYXRjaCByZXF1ZXN0ZWQgdmFsdWUgKCR7Ym9vbEVuYWJsZWR9KS4gQXR0ZW1wdGluZyB0byBmaXguLi5gKTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBUcnkgc2V0dGluZyBkaXJlY3RseSB3aXRoIHRoZSBkb3Qgbm90YXRpb25cclxuICAgICAgICBzZXR0aW5nc1N0b3JlLnNldCgnb2NyLmVuYWJsZWQnLCBib29sRW5hYmxlZCk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gVmVyaWZ5IGFnYWluXHJcbiAgICAgICAgY29uc3QgcmVjaGVjayA9IHNldHRpbmdzU3RvcmUuZ2V0KCdvY3InKTtcclxuICAgICAgICBjb25zb2xlLmxvZyhgW1NldHRpbmdzXSBBZnRlciBmaXggYXR0ZW1wdCwgT0NSIGVuYWJsZWQgaXM6ICR7cmVjaGVjay5lbmFibGVkfSAodHlwZTogJHt0eXBlb2YgcmVjaGVjay5lbmFibGVkfSlgKTtcclxuICAgICAgfVxyXG4gICAgICBcclxuICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgdmFsdWU6IHNhdmVkT2NyLmVuYWJsZWQgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHNldHRpbmcgT0NSIGVuYWJsZWQ6JywgZXJyb3IpO1xyXG4gICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICAgIH1cclxuICB9KTtcclxufVxyXG4vKipcclxuICogR2V0IGEgc2V0dGluZyB2YWx1ZSBkaXJlY3RseSAoZm9yIHVzZSBieSBvdGhlciBtb2R1bGVzKVxyXG4gKiBAcGFyYW0ge3N0cmluZ30ga2V5IC0gVGhlIHNldHRpbmcga2V5XHJcbiAqIEBwYXJhbSB7YW55fSBkZWZhdWx0VmFsdWUgLSBEZWZhdWx0IHZhbHVlIGlmIHNldHRpbmcgbm90IGZvdW5kXHJcbiAqIEByZXR1cm5zIHthbnl9IFRoZSBzZXR0aW5nIHZhbHVlXHJcbiAqL1xyXG5mdW5jdGlvbiBnZXRTZXR0aW5nVmFsdWUoa2V5LCBkZWZhdWx0VmFsdWUpIHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgcGFydHMgPSBrZXkuc3BsaXQoJy4nKTtcclxuICAgIGxldCB2YWx1ZSA9IHNldHRpbmdzU3RvcmUuZ2V0KHBhcnRzWzBdLCBERUZBVUxUX1NFVFRJTkdTW3BhcnRzWzBdXSk7XHJcbiAgICBcclxuICAgIC8vIE5hdmlnYXRlIHRocm91Z2ggbmVzdGVkIHByb3BlcnRpZXNcclxuICAgIGZvciAobGV0IGkgPSAxOyBpIDwgcGFydHMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgaWYgKHZhbHVlID09PSB1bmRlZmluZWQgfHwgdmFsdWUgPT09IG51bGwpIHJldHVybiBkZWZhdWx0VmFsdWU7XHJcbiAgICAgIHZhbHVlID0gdmFsdWVbcGFydHNbaV1dO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICByZXR1cm4gdmFsdWUgIT09IHVuZGVmaW5lZCA/IHZhbHVlIDogZGVmYXVsdFZhbHVlO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKGBFcnJvciBnZXR0aW5nIHNldHRpbmcgJHtrZXl9OmAsIGVycm9yKTtcclxuICAgIHJldHVybiBkZWZhdWx0VmFsdWU7XHJcbiAgfVxyXG59XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IHtcclxuICByZWdpc3RlckhhbmRsZXJzLFxyXG4gIGdldFNldHRpbmdWYWx1ZVxyXG59O1xyXG4iXSwibWFwcGluZ3MiOiI7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxNQUFNO0VBQUVBO0FBQVEsQ0FBQyxHQUFHQyxPQUFPLENBQUMsVUFBVSxDQUFDO0FBQ3ZDLE1BQU07RUFBRUM7QUFBWSxDQUFDLEdBQUdELE9BQU8sQ0FBQywwQkFBMEIsQ0FBQzs7QUFFM0Q7QUFDQSxNQUFNRSxhQUFhLEdBQUdELFdBQVcsQ0FBQyxVQUFVLEVBQUU7RUFDNUNFLGFBQWEsRUFBRUMsT0FBTyxDQUFDQyxHQUFHLENBQUNDO0FBQzdCLENBQUMsQ0FBQzs7QUFFRjtBQUNBLE1BQU1DLGdCQUFnQixHQUFHO0VBQ3ZCQyxHQUFHLEVBQUU7SUFDSEMsT0FBTyxFQUFFO0VBQ1gsQ0FBQztFQUNEQyxhQUFhLEVBQUU7SUFDYkMsS0FBSyxFQUFFO0VBQ1Q7QUFDRixDQUFDOztBQUVEO0FBQ0EsU0FBU0MsZ0JBQWdCQSxDQUFBLEVBQUc7RUFDMUI7RUFDQWIsT0FBTyxDQUFDYyxNQUFNLENBQUMsbUJBQW1CLEVBQUUsT0FBT0MsS0FBSyxFQUFFQyxHQUFHLEtBQUs7SUFDeEQsSUFBSTtNQUNGLE1BQU1DLEtBQUssR0FBR0QsR0FBRyxDQUFDRSxLQUFLLENBQUMsR0FBRyxDQUFDO01BQzVCLElBQUlDLEtBQUssR0FBR2hCLGFBQWEsQ0FBQ2lCLEdBQUcsQ0FBQ0gsS0FBSyxDQUFDLENBQUMsQ0FBQyxFQUFFVCxnQkFBZ0IsQ0FBQ1MsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7O01BRW5FO01BQ0EsS0FBSyxJQUFJSSxDQUFDLEdBQUcsQ0FBQyxFQUFFQSxDQUFDLEdBQUdKLEtBQUss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