"use strict";

/**
 * Markdown Utilities
 * Provides functionality for handling markdown content in the electron process
 * 
 * This module contains utilities for working with markdown content, including
 * frontmatter extraction and formatting, metadata handling, and content cleaning.
 * 
 * Used by:
 * - src/electron/services/ConversionResultManager.js
 * - src/electron/converters/UnifiedConverterFactory.js
 */

/**
 * Format metadata as YAML frontmatter
 * @param {Object} metadata - Metadata object to format
 * @returns {string} Formatted YAML frontmatter
 */
function formatMetadata(metadata = {}) {
  if (!metadata || Object.keys(metadata).length === 0) {
    return '';
  }
  try {
    // Convert metadata to YAML-like format
    const lines = ['---'];
    for (const [key, value] of Object.entries(metadata)) {
      if (value !== undefined && value !== null) {
        if (Array.isArray(value)) {
          lines.push(`${key}:`);
          value.forEach(item => lines.push(`  - ${item}`));
        } else if (typeof value === 'object') {
          lines.push(`${key}:`);
          Object.entries(value).forEach(([k, v]) => {
            lines.push(`  ${k}: ${v}`);
          });
        } else {
          lines.push(`${key}: ${value}`);
        }
      }
    }
    lines.push('---\n');
    return lines.join('\n');
  } catch (error) {
    console.error('Error formatting metadata:', error);
    return '';
  }
}

/**
 * Clean metadata fields to ensure valid values
 * @param {Object} metadata - Metadata object to clean
 * @returns {Object} Cleaned metadata
 */
function cleanMetadata(metadata = {}) {
  const cleaned = {};
  for (const [key, value] of Object.entries(metadata)) {
    if (value !== undefined && value !== null) {
      if (Array.isArray(value)) {
        cleaned[key] = value.filter(item => item !== null && item !== undefined);
      } else if (typeof value === 'object') {
        cleaned[key] = cleanMetadata(value);
      } else {
        cleaned[key] = value;
      }
    }
  }
  return cleaned;
}

/**
 * Extract frontmatter and content from markdown text
 * @param {string} text - Markdown text
 * @returns {Object} Object with metadata and content
 */
function extractFrontmatter(text) {
  if (typeof text !== 'string') {
    return {
      metadata: {},
      content: text || ''
    };
  }
  try {
    const match = text.match(/^---\n([\s\S]*?)\n---\n([\s\S]*)$/);
    if (!match) {
      return {
        metadata: {},
        content: text
      };
    }
    const [, frontmatter, content] = match;
    const metadata = {};

    // Parse YAML-like frontmatter
    const lines = frontmatter.split('\n');
    let currentKey = null;
    let isList = false;
    for (const line of lines) {
      const keyMatch = line.match(/^([^:]+):\s*(.*)$/);
      const listItemMatch = line.match(/^\s*-\s*(.+)$/);
      if (keyMatch) {
        const [, key, value] = keyMatch;
        currentKey = key.trim();
        if (value.trim()) {
          metadata[currentKey] = value.trim();
          isList = false;
        } else {
          metadata[currentKey] = [];
          isList = true;
        }
      } else if (listItemMatch && currentKey && isList) {
        if (!Array.isArray(metadata[currentKey])) {
          metadata[currentKey] = [];
        }
        metadata[currentKey].push(listItemMatch[1].trim());
      }
    }
    return {
      metadata,
      content: content.trimStart()
    };
  } catch (error) {
    console.error('Error extracting frontmatter:', error);
    return {
      metadata: {},
      content: text
    };
  }
}

/**
 * Merge two metadata objects with optional overrides
 * @param {Object} base - Base metadata object
 * @param {Object} update - Update metadata object
 * @param {Object} overrides - Override values that take precedence
 * @returns {Object} Merged metadata
 */
function mergeMetadata(base = {}, update = {}, overrides = {}) {
  const merged = {
    ...base
  };

  // Merge update object
  for (const [key, value] of Object.entries(update)) {
    if (value !== undefined && value !== null) {
      if (Array.isArray(value)) {
        merged[key] = [...new Set([...(merged[key] || []), ...value])];
      } else if (typeof value === 'object') {
        merged[key] = {
          ...(merged[key] || {}),
          ...value
        };
      } else {
        merged[key] = value;
      }
    }
  }

  // Apply overrides
  for (const [key, value] of Object.entries(overrides)) {
    if (value !== undefined && value !== null) {
      merged[key] = value;
    }
  }
  return merged;
}
module.exports = {
  formatMetadata,
  cleanMetadata,
  extractFrontmatter,
  mergeMetadata
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJmb3JtYXRNZXRhZGF0YSIsIm1ldGFkYXRhIiwiT2JqZWN0Iiwia2V5cyIsImxlbmd0aCIsImxpbmVzIiwia2V5IiwidmFsdWUiLCJlbnRyaWVzIiwidW5kZWZpbmVkIiwiQXJyYXkiLCJpc0FycmF5IiwicHVzaCIsImZvckVhY2giLCJpdGVtIiwiayIsInYiLCJqb2luIiwiZXJyb3IiLCJjb25zb2xlIiwiY2xlYW5NZXRhZGF0YSIsImNsZWFuZWQiLCJmaWx0ZXIiLCJleHRyYWN0RnJvbnRtYXR0ZXIiLCJ0ZXh0IiwiY29udGVudCIsIm1hdGNoIiwiZnJvbnRtYXR0ZXIiLCJzcGxpdCIsImN1cnJlbnRLZXkiLCJpc0xpc3QiLCJsaW5lIiwia2V5TWF0Y2giLCJsaXN0SXRlbU1hdGNoIiwidHJpbSIsInRyaW1TdGFydCIsIm1lcmdlTWV0YWRhdGEiLCJiYXNlIiwidXBkYXRlIiwib3ZlcnJpZGVzIiwibWVyZ2VkIiwiU2V0IiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9lbGVjdHJvbi91dGlscy9tYXJrZG93bi9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogTWFya2Rvd24gVXRpbGl0aWVzXHJcbiAqIFByb3ZpZGVzIGZ1bmN0aW9uYWxpdHkgZm9yIGhhbmRsaW5nIG1hcmtkb3duIGNvbnRlbnQgaW4gdGhlIGVsZWN0cm9uIHByb2Nlc3NcclxuICogXHJcbiAqIFRoaXMgbW9kdWxlIGNvbnRhaW5zIHV0aWxpdGllcyBmb3Igd29ya2luZyB3aXRoIG1hcmtkb3duIGNvbnRlbnQsIGluY2x1ZGluZ1xyXG4gKiBmcm9udG1hdHRlciBleHRyYWN0aW9uIGFuZCBmb3JtYXR0aW5nLCBtZXRhZGF0YSBoYW5kbGluZywgYW5kIGNvbnRlbnQgY2xlYW5pbmcuXHJcbiAqIFxyXG4gKiBVc2VkIGJ5OlxyXG4gKiAtIHNyYy9lbGVjdHJvbi9zZXJ2aWNlcy9Db252ZXJzaW9uUmVzdWx0TWFuYWdlci5qc1xyXG4gKiAtIHNyYy9lbGVjdHJvbi9jb252ZXJ0ZXJzL1VuaWZpZWRDb252ZXJ0ZXJGYWN0b3J5LmpzXHJcbiAqL1xyXG5cclxuLyoqXHJcbiAqIEZvcm1hdCBtZXRhZGF0YSBhcyBZQU1MIGZyb250bWF0dGVyXHJcbiAqIEBwYXJhbSB7T2JqZWN0fSBtZXRhZGF0YSAtIE1ldGFkYXRhIG9iamVjdCB0byBmb3JtYXRcclxuICogQHJldHVybnMge3N0cmluZ30gRm9ybWF0dGVkIFlBTUwgZnJvbnRtYXR0ZXJcclxuICovXHJcbmZ1bmN0aW9uIGZvcm1hdE1ldGFkYXRhKG1ldGFkYXRhID0ge30pIHtcclxuICAgIGlmICghbWV0YWRhdGEgfHwgT2JqZWN0LmtleXMobWV0YWRhdGEpLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgIHJldHVybiAnJztcclxuICAgIH1cclxuXHJcbiAgICB0cnkge1xyXG4gICAgICAgIC8vIENvbnZlcnQgbWV0YWRhdGEgdG8gWUFNTC1saWtlIGZvcm1hdFxyXG4gICAgICAgIGNvbnN0IGxpbmVzID0gWyctLS0nXTtcclxuICAgICAgICBcclxuICAgICAgICBmb3IgKGNvbnN0IFtrZXksIHZhbHVlXSBvZiBPYmplY3QuZW50cmllcyhtZXRhZGF0YSkpIHtcclxuICAgICAgICAgICAgaWYgKHZhbHVlICE9PSB1bmRlZmluZWQgJiYgdmFsdWUgIT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KHZhbHVlKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGxpbmVzLnB1c2goYCR7a2V5fTpgKTtcclxuICAgICAgICAgICAgICAgICAgICB2YWx1ZS5mb3JFYWNoKGl0ZW0gPT4gbGluZXMucHVzaChgICAtICR7aXRlbX1gKSk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcpIHtcclxuICAgICAgICAgICAgICAgICAgICBsaW5lcy5wdXNoKGAke2tleX06YCk7XHJcbiAgICAgICAgICAgICAgICAgICAgT2JqZWN0LmVudHJpZXModmFsdWUpLmZvckVhY2goKFtrLCB2XSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsaW5lcy5wdXNoKGAgICR7a306ICR7dn1gKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGluZXMucHVzaChgJHtrZXl9OiAke3ZhbHVlfWApO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIGxpbmVzLnB1c2goJy0tLVxcbicpO1xyXG4gICAgICAgIHJldHVybiBsaW5lcy5qb2luKCdcXG4nKTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZm9ybWF0dGluZyBtZXRhZGF0YTonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuICcnO1xyXG4gICAgfVxyXG59XHJcblxyXG4vKipcclxuICogQ2xlYW4gbWV0YWRhdGEgZmllbGRzIHRvIGVuc3VyZSB2YWxpZCB2YWx1ZXNcclxuICogQHBhcmFtIHtPYmplY3R9IG1ldGFkYXRhIC0gTWV0YWRhdGEgb2JqZWN0IHRvIGNsZWFuXHJcbiAqIEByZXR1cm5zIHtPYmplY3R9IENsZWFuZWQgbWV0YWRhdGFcclxuICovXHJcbmZ1bmN0aW9uIGNsZWFuTWV0YWRhdGEobWV0YWRhdGEgPSB7fSkge1xyXG4gICAgY29uc3QgY2xlYW5lZCA9IHt9O1xyXG4gICAgXHJcbiAgICBmb3IgKGNvbnN0IFtrZXksIHZhbHVlXSBvZiBPYmplY3QuZW50cmllcyhtZXRhZGF0YSkpIHtcclxuICAgICAgICBpZiAodmFsdWUgIT09IHVuZGVmaW5lZCAmJiB2YWx1ZSAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheSh2YWx1ZSkpIHtcclxuICAgICAgICAgICAgICAgIGNsZWFuZWRba2V5XSA9IHZhbHVlLmZpbHRlcihpdGVtID0+IGl0ZW0gIT09IG51bGwgJiYgaXRlbSAhPT0gdW5kZWZpbmVkKTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnKSB7XHJcbiAgICAgICAgICAgICAgICBjbGVhbmVkW2tleV0gPSBjbGVhbk1ldGFkYXRhKHZhbHVlKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGNsZWFuZWRba2V5XSA9IHZhbHVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICByZXR1cm4gY2xlYW5lZDtcclxufVxyXG5cclxuLyoqXHJcbiAqIEV4dHJhY3QgZnJvbnRtYXR0ZXIgYW5kIGNvbnRlbnQgZnJvbSBtYXJrZG93biB0ZXh0XHJcbiAqIEBwYXJhbSB7c3RyaW5nfSB0ZXh0IC0gTWFya2Rvd24gdGV4dFxyXG4gKiBAcmV0dXJucyB7T2JqZWN0fSBPYmplY3Qgd2l0aCBtZXRhZGF0YSBhbmQgY29udGVudFxyXG4gKi9cclxuZnVuY3Rpb24gZXh0cmFjdEZyb250bWF0dGVyKHRleHQpIHtcclxuICAgIGlmICh0eXBlb2YgdGV4dCAhPT0gJ3N0cmluZycpIHtcclxuICAgICAgICByZXR1cm4geyBtZXRhZGF0YToge30sIGNvbnRlbnQ6IHRleHQgfHwgJycgfTtcclxuICAgIH1cclxuXHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IG1hdGNoID0gdGV4dC5tYXRjaCgvXi0tLVxcbihbXFxzXFxTXSo/KVxcbi0tLVxcbihbXFxzXFxTXSopJC8pO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGlmICghbWF0Y2gpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHsgbWV0YWRhdGE6IHt9LCBjb250ZW50OiB0ZXh0IH07XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCBbLCBmcm9udG1hdHRlciwgY29udGVudF0gPSBtYXRjaDtcclxuICAgICAgICBjb25zdCBtZXRhZGF0YSA9IHt9O1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIFBhcnNlIFlBTUwtbGlrZSBmcm9udG1hdHRlclxyXG4gICAgICAgIGNvbnN0IGxpbmVzID0gZnJvbnRtYXR0ZXIuc3BsaXQoJ1xcbicpO1xyXG4gICAgICAgIGxldCBjdXJyZW50S2V5ID0gbnVsbDtcclxuICAgICAgICBsZXQgaXNMaXN0ID0gZmFsc2U7XHJcbiAgICAgICAgXHJcbiAgICAgICAgZm9yIChjb25zdCBsaW5lIG9mIGxpbmVzKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGtleU1hdGNoID0gbGluZS5tYXRjaCgvXihbXjpdKyk6XFxzKiguKikkLyk7XHJcbiAgICAgICAgICAgIGNvbnN0IGxpc3RJdGVtTWF0Y2ggPSBsaW5lLm1hdGNoKC9eXFxzKi1cXHMqKC4rKSQvKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGlmIChrZXlNYXRjaCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgWywga2V5LCB2YWx1ZV0gPSBrZXlNYXRjaDtcclxuICAgICAgICAgICAgICAgIGN1cnJlbnRLZXkgPSBrZXkudHJpbSgpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHZhbHVlLnRyaW0oKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIG1ldGFkYXRhW2N1cnJlbnRLZXldID0gdmFsdWUudHJpbSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlzTGlzdCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBtZXRhZGF0YVtjdXJyZW50S2V5XSA9IFtdO1xyXG4gICAgICAgICAgICAgICAgICAgIGlzTGlzdCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAobGlzdEl0ZW1NYXRjaCAmJiBjdXJyZW50S2V5ICYmIGlzTGlzdCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCFBcnJheS5pc0FycmF5KG1ldGFkYXRhW2N1cnJlbnRLZXldKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIG1ldGFkYXRhW2N1cnJlbnRLZXldID0gW107XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBtZXRhZGF0YVtjdXJyZW50S2V5XS5wdXNoKGxpc3RJdGVtTWF0Y2hbMV0udHJpbSgpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHsgbWV0YWRhdGEsIGNvbnRlbnQ6IGNvbnRlbnQudHJpbVN0YXJ0KCkgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZXh0cmFjdGluZyBmcm9udG1hdHRlcjonLCBlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuIHsgbWV0YWRhdGE6IHt9LCBjb250ZW50OiB0ZXh0IH07XHJcbiAgICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBNZXJnZSB0d28gbWV0YWRhdGEgb2JqZWN0cyB3aXRoIG9wdGlvbmFsIG92ZXJyaWRlc1xyXG4gKiBAcGFyYW0ge09iamVjdH0gYmFzZSAtIEJhc2UgbWV0YWRhdGEgb2JqZWN0XHJcbiAqIEBwYXJhbSB7T2JqZWN0fSB1cGRhdGUgLSBVcGRhdGUgbWV0YWRhdGEgb2JqZWN0XHJcbiAqIEBwYXJhbSB7T2JqZWN0fSBvdmVycmlkZXMgLSBPdmVycmlkZSB2YWx1ZXMgdGhhdCB0YWtlIHByZWNlZGVuY2VcclxuICogQHJldHVybnMge09iamVjdH0gTWVyZ2VkIG1ldGFkYXRhXHJcbiAqL1xyXG5mdW5jdGlvbiBtZXJnZU1ldGFkYXRhKGJhc2UgPSB7fSwgdXBkYXRlID0ge30sIG92ZXJyaWRlcyA9IHt9KSB7XHJcbiAgICBjb25zdCBtZXJnZWQgPSB7IC4uLmJhc2UgfTtcclxuXHJcbiAgICAvLyBNZXJnZSB1cGRhdGUgb2JqZWN0XHJcbiAgICBmb3IgKGNvbnN0IFtrZXksIHZhbHVlXSBvZiBPYmplY3QuZW50cmllcyh1cGRhdGUpKSB7XHJcbiAgICAgICAgaWYgKHZhbHVlICE9PSB1bmRlZmluZWQgJiYgdmFsdWUgIT09IG51bGwpIHtcclxuICAgICAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkodmFsdWUpKSB7XHJcbiAgICAgICAgICAgICAgICBtZXJnZWRba2V5XSA9IFsuLi5uZXcgU2V0KFsuLi4obWVyZ2VkW2tleV0gfHwgW10pLCAuLi52YWx1ZV0pXTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnKSB7XHJcbiAgICAgICAgICAgICAgICBtZXJnZWRba2V5XSA9IHtcclxuICAgICAgICAgICAgICAgICAgICAuLi4obWVyZ2VkW2tleV0gfHwge30pLFxyXG4gICAgICAgICAgICAgICAgICAgIC4uLnZhbHVlXHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgbWVyZ2VkW2tleV0gPSB2YWx1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyBBcHBseSBvdmVycmlkZXNcclxuICAgIGZvciAoY29uc3QgW2tleSwgdmFsdWVdIG9mIE9iamVjdC5lbnRyaWVzKG92ZXJyaWRlcykpIHtcclxuICAgICAgICBpZiAodmFsdWUgIT09IHVuZGVmaW5lZCAmJiB2YWx1ZSAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgICBtZXJnZWRba2V5XSA9IHZhbHVlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gbWVyZ2VkO1xyXG59XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IHtcclxuICAgIGZvcm1hdE1ldGFkYXRhLFxyXG4gICAgY2xlYW5NZXRhZGF0YSxcclxuICAgIGV4dHJhY3RGcm9udG1hdHRlcixcclxuICAgIG1lcmdlTWV0YWRhdGFcclxufTtcclxuIl0sIm1hcHBpbmdzIjoiOztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7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