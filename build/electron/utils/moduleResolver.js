"use strict";

/**
 * moduleResolver.js
 * A utility for resolving module paths across different environments (development vs production)
 * Specifically designed to handle path differences in Electron's packaged apps
 */

const path = require('path');
const fs = require('fs-extra');
const electron = require('electron');

// Handle app access in both main and renderer process
const app = electron.app || electron.remote && electron.remote.app;
class ModuleResolver {
  /**
   * Resolves a module path by trying multiple possible locations
   * @param {string} moduleName - The filename of the module (e.g. 'ConverterRegistry.js')
   * @param {string} category - The category path (e.g. 'services/conversion')
   * @returns {string} The resolved path to the module
   */
  static resolveModulePath(moduleName, category) {
    // Get logger for verbose logging
    let logger;
    try {
      logger = require('../utils/logger');
    } catch (e) {
      logger = {
        log: console.log,
        error: console.error,
        warn: console.warn,
        debug: console.debug
      };
    }
    logger.log(`üîç [ModuleResolver] Resolving path for ${moduleName} in ${category}`);
    let appPath;
    try {
      // Get app path in a safe way that works in both packaged and development
      appPath = app ? app.getAppPath() : process.cwd();
    } catch (e) {
      logger.warn(`‚ö†Ô∏è [ModuleResolver] Error getting app path: ${e.message}`);
      appPath = process.cwd();
    }

    // Build comprehensive search paths
    const searchPaths = [
    // Build paths (preferred)
    path.join(appPath, 'build/electron', category, moduleName),
    // Source paths
    path.join(appPath, 'src/electron', category, moduleName),
    // Resource paths for packaged app
    path.join(process.resourcesPath || '', 'app/build/electron', category, moduleName), path.join(process.resourcesPath || '', 'app/src/electron', category, moduleName),
    // External modules directory (created by after-pack.js)
    path.join(process.resourcesPath || '', 'modules/build/electron', category, moduleName), path.join(process.resourcesPath || '', 'modules/src/electron', category, moduleName),
    // Relative paths from current module
    path.join(__dirname, '..', category, moduleName), path.join(__dirname, '../..', category, moduleName),
    // Direct paths for known problematic modules
    category === 'services/conversion' && moduleName === 'ConverterRegistry.js' ? path.join(appPath, 'build/electron/services/conversion/ConverterRegistry.js') : null, category === 'services/conversion' && moduleName === 'ConverterRegistry.js' ? path.join(appPath, 'src/electron/services/conversion/ConverterRegistry.js') : null,
    // Asar-specific paths
    path.join(appPath.replace('app.asar', 'app'), 'build/electron', category, moduleName), path.join(appPath.replace('app.asar', 'app'), 'src/electron', category, moduleName),
    // Modules fallback when packaged
    path.join(appPath.replace('app.asar', 'modules'), 'build/electron', category, moduleName), path.join(appPath.replace('app.asar', 'modules'), 'src/electron', category, moduleName),
    // Extreme fallback for the specific problem path we've seen
    category === 'services/conversion' && moduleName === 'ConverterRegistry.js' ? 'C:\\Users\\Joseph\\Documents\\Code\\codex-md\\dist\\win-unpacked\\resources\\app.asar\\build\\electron\\services\\conversion\\ConverterRegistry.js' : null,
    // Check for the external modules directory in various locations
    category === 'services/conversion' && moduleName === 'ConverterRegistry.js' ? 'C:\\Users\\Joseph\\Documents\\Code\\codex-md\\dist\\win-unpacked\\resources\\modules\\build\\electron\\services\\conversion\\ConverterRegistry.js' : null].filter(Boolean); // Remove null entries

    // Find first existing path
    for (const searchPath of searchPaths) {
      try {
        const exists = fs.existsSync(searchPath);
        if (exists) {
          logger.log(`‚úÖ [ModuleResolver] Found module at: ${searchPath}`);
          return searchPath;
        }
      } catch (error) {
        logger.warn(`‚ö†Ô∏è [ModuleResolver] Error checking path ${searchPath}: ${error.message}`);
      }
    }

    // If no path found, return the most likely path - will fail but with a clear error
    logger.warn(`‚ö†Ô∏è [ModuleResolver] No existing module found, returning default path`);
    return path.join(appPath, 'build/electron', category, moduleName);
  }

  /**
   * Safely requires a module by resolving its path first
   * @param {string} moduleName - The filename of the module (e.g. 'ConverterRegistry.js')
   * @param {string} category - The category path (e.g. 'services/conversion')
   * @returns {any} The loaded module
   * @throws {Error} If the module cannot be loaded
   */
  static safeRequire(moduleName, category) {
    // Get logger for verbose logging
    let logger;
    try {
      logger = require('../utils/logger');
    } catch (e) {
      logger = {
        log: console.log,
        error: console.error,
        warn: console.warn,
        debug: console.debug
      };
    }
    const modulePath = this.resolveModulePath(moduleName, category);
    logger.log(`üîÑ [ModuleResolver] Requiring module from: ${modulePath}`);
    try {
      const module = require(modulePath);
      logger.log(`‚úÖ [ModuleResolver] Successfully loaded module: ${moduleName}`);
      return module.default || module;
    } catch (error) {
      logger.error(`‚ùå [ModuleResolver] Failed to load module: ${moduleName} from ${modulePath}`);
      logger.error(`‚ùå [ModuleResolver] Error details: ${error.message}`);

      // Try one more approach - direct require
      try {
        if (category === 'services/conversion' && moduleName === 'ConverterRegistry.js') {
          logger.log(`üîÑ [ModuleResolver] Trying direct require for ConverterRegistry.js`);
          return require('../services/conversion/ConverterRegistry.js');
        }
      } catch (directError) {
        logger.warn(`‚ö†Ô∏è [ModuleResolver] Direct require also failed: ${directError.message}`);
      }

      // Rethrow the original error with more context
      throw new Error(`Failed to load module: ${moduleName} from ${modulePath}. Error: ${error.message}`);
    }
  }

  /**
   * Get all the search paths for a module without loading it
   * @param {string} moduleName - The filename of the module
   * @param {string} category - The category path
   * @returns {Array<string>} Array of possible paths
   */
  static getAllPaths(moduleName, category) {
    let appPath;
    try {
      appPath = app ? app.getAppPath() : process.cwd();
    } catch (e) {
      appPath = process.cwd();
    }
    return [
    // Build paths (preferred)
    path.join(appPath, 'build/electron', category, moduleName),
    // Source paths
    path.join(appPath, 'src/electron', category, moduleName),
    // Resource paths for packaged app
    path.join(process.resourcesPath || '', 'app/build/electron', category, moduleName), path.join(process.resourcesPath || '', 'app/src/electron', category, moduleName),
    // External modules directory (created by after-pack.js)
    path.join(process.resourcesPath || '', 'modules/build/electron', category, moduleName), path.join(process.resourcesPath || '', 'modules/src/electron', category, moduleName),
    // Relative paths from current module
    path.join(__dirname, '..', category, moduleName), path.join(__dirname, '../..', category, moduleName),
    // Asar-specific paths
    path.join(appPath.replace('app.asar', 'app'), 'build/electron', category, moduleName), path.join(appPath.replace('app.asar', 'app'), 'src/electron', category, moduleName),
    // Modules fallback when packaged
    path.join(appPath.replace('app.asar', 'modules'), 'build/electron', category, moduleName), path.join(appPath.replace('app.asar', 'modules'), 'src/electron', category, moduleName),
    // Hardcoded fallbacks for Windows
    category === 'services/conversion' && moduleName === 'ConverterRegistry.js' ? 'C:\\Users\\Joseph\\Documents\\Code\\codex-md\\dist\\win-unpacked\\resources\\modules\\build\\electron\\services\\conversion\\ConverterRegistry.js' : null].filter(Boolean);
  }
}
module.exports = {
  ModuleResolver
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJwYXRoIiwicmVxdWlyZSIsImZzIiwiZWxlY3Ryb24iLCJhcHAiLCJyZW1vdGUiLCJNb2R1bGVSZXNvbHZlciIsInJlc29sdmVNb2R1bGVQYXRoIiwibW9kdWxlTmFtZSIsImNhdGVnb3J5IiwibG9nZ2VyIiwiZSIsImxvZyIsImNvbnNvbGUiLCJlcnJvciIsIndhcm4iLCJkZWJ1ZyIsImFwcFBhdGgiLCJnZXRBcHBQYXRoIiwicHJvY2VzcyIsImN3ZCIsIm1lc3NhZ2UiLCJzZWFyY2hQYXRocyIsImpvaW4iLCJyZXNvdXJjZXNQYXRoIiwiX19kaXJuYW1lIiwicmVwbGFjZSIsImZpbHRlciIsIkJvb2xlYW4iLCJzZWFyY2hQYXRoIiwiZXhpc3RzIiwiZXhpc3RzU3luYyIsInNhZmVSZXF1aXJlIiwibW9kdWxlUGF0aCIsIm1vZHVsZSIsImRlZmF1bHQiLCJkaXJlY3RFcnJvciIsIkVycm9yIiwiZ2V0QWxsUGF0aHMiLCJleHBvcnRzIl0sInNvdXJjZXMiOlsiLi4vLi4vLi4vc3JjL2VsZWN0cm9uL3V0aWxzL21vZHVsZVJlc29sdmVyLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBtb2R1bGVSZXNvbHZlci5qc1xyXG4gKiBBIHV0aWxpdHkgZm9yIHJlc29sdmluZyBtb2R1bGUgcGF0aHMgYWNyb3NzIGRpZmZlcmVudCBlbnZpcm9ubWVudHMgKGRldmVsb3BtZW50IHZzIHByb2R1Y3Rpb24pXHJcbiAqIFNwZWNpZmljYWxseSBkZXNpZ25lZCB0byBoYW5kbGUgcGF0aCBkaWZmZXJlbmNlcyBpbiBFbGVjdHJvbidzIHBhY2thZ2VkIGFwcHNcclxuICovXHJcblxyXG5jb25zdCBwYXRoID0gcmVxdWlyZSgncGF0aCcpO1xyXG5jb25zdCBmcyA9IHJlcXVpcmUoJ2ZzLWV4dHJhJyk7XHJcbmNvbnN0IGVsZWN0cm9uID0gcmVxdWlyZSgnZWxlY3Ryb24nKTtcclxuXHJcbi8vIEhhbmRsZSBhcHAgYWNjZXNzIGluIGJvdGggbWFpbiBhbmQgcmVuZGVyZXIgcHJvY2Vzc1xyXG5jb25zdCBhcHAgPSBlbGVjdHJvbi5hcHAgfHwgKGVsZWN0cm9uLnJlbW90ZSAmJiBlbGVjdHJvbi5yZW1vdGUuYXBwKTtcclxuXHJcbmNsYXNzIE1vZHVsZVJlc29sdmVyIHtcclxuICAvKipcclxuICAgKiBSZXNvbHZlcyBhIG1vZHVsZSBwYXRoIGJ5IHRyeWluZyBtdWx0aXBsZSBwb3NzaWJsZSBsb2NhdGlvbnNcclxuICAgKiBAcGFyYW0ge3N0cmluZ30gbW9kdWxlTmFtZSAtIFRoZSBmaWxlbmFtZSBvZiB0aGUgbW9kdWxlIChlLmcuICdDb252ZXJ0ZXJSZWdpc3RyeS5qcycpXHJcbiAgICogQHBhcmFtIHtzdHJpbmd9IGNhdGVnb3J5IC0gVGhlIGNhdGVnb3J5IHBhdGggKGUuZy4gJ3NlcnZpY2VzL2NvbnZlcnNpb24nKVxyXG4gICAqIEByZXR1cm5zIHtzdHJpbmd9IFRoZSByZXNvbHZlZCBwYXRoIHRvIHRoZSBtb2R1bGVcclxuICAgKi9cclxuICBzdGF0aWMgcmVzb2x2ZU1vZHVsZVBhdGgobW9kdWxlTmFtZSwgY2F0ZWdvcnkpIHtcclxuICAgIC8vIEdldCBsb2dnZXIgZm9yIHZlcmJvc2UgbG9nZ2luZ1xyXG4gICAgbGV0IGxvZ2dlcjtcclxuICAgIHRyeSB7XHJcbiAgICAgIGxvZ2dlciA9IHJlcXVpcmUoJy4uL3V0aWxzL2xvZ2dlcicpO1xyXG4gICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICBsb2dnZXIgPSB7XHJcbiAgICAgICAgbG9nOiBjb25zb2xlLmxvZyxcclxuICAgICAgICBlcnJvcjogY29uc29sZS5lcnJvcixcclxuICAgICAgICB3YXJuOiBjb25zb2xlLndhcm4sXHJcbiAgICAgICAgZGVidWc6IGNvbnNvbGUuZGVidWdcclxuICAgICAgfTtcclxuICAgIH1cclxuXHJcbiAgICBsb2dnZXIubG9nKGDwn5SNIFtNb2R1bGVSZXNvbHZlcl0gUmVzb2x2aW5nIHBhdGggZm9yICR7bW9kdWxlTmFtZX0gaW4gJHtjYXRlZ29yeX1gKTtcclxuXHJcbiAgICBsZXQgYXBwUGF0aDtcclxuICAgIHRyeSB7XHJcbiAgICAgIC8vIEdldCBhcHAgcGF0aCBpbiBhIHNhZmUgd2F5IHRoYXQgd29ya3MgaW4gYm90aCBwYWNrYWdlZCBhbmQgZGV2ZWxvcG1lbnRcclxuICAgICAgYXBwUGF0aCA9IGFwcCA/IGFwcC5nZXRBcHBQYXRoKCkgOiBwcm9jZXNzLmN3ZCgpO1xyXG4gICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICBsb2dnZXIud2Fybihg4pqg77iPIFtNb2R1bGVSZXNvbHZlcl0gRXJyb3IgZ2V0dGluZyBhcHAgcGF0aDogJHtlLm1lc3NhZ2V9YCk7XHJcbiAgICAgIGFwcFBhdGggPSBwcm9jZXNzLmN3ZCgpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIEJ1aWxkIGNvbXByZWhlbnNpdmUgc2VhcmNoIHBhdGhzXHJcbiAgICBjb25zdCBzZWFyY2hQYXRocyA9IFtcclxuICAgICAgLy8gQnVpbGQgcGF0aHMgKHByZWZlcnJlZClcclxuICAgICAgcGF0aC5qb2luKGFwcFBhdGgsICdidWlsZC9lbGVjdHJvbicsIGNhdGVnb3J5LCBtb2R1bGVOYW1lKSxcclxuXHJcbiAgICAgIC8vIFNvdXJjZSBwYXRoc1xyXG4gICAgICBwYXRoLmpvaW4oYXBwUGF0aCwgJ3NyYy9lbGVjdHJvbicsIGNhdGVnb3J5LCBtb2R1bGVOYW1lKSxcclxuXHJcbiAgICAgIC8vIFJlc291cmNlIHBhdGhzIGZvciBwYWNrYWdlZCBhcHBcclxuICAgICAgcGF0aC5qb2luKHByb2Nlc3MucmVzb3VyY2VzUGF0aCB8fCAnJywgJ2FwcC9idWlsZC9lbGVjdHJvbicsIGNhdGVnb3J5LCBtb2R1bGVOYW1lKSxcclxuICAgICAgcGF0aC5qb2luKHByb2Nlc3MucmVzb3VyY2VzUGF0aCB8fCAnJywgJ2FwcC9zcmMvZWxlY3Ryb24nLCBjYXRlZ29yeSwgbW9kdWxlTmFtZSksXHJcblxyXG4gICAgICAvLyBFeHRlcm5hbCBtb2R1bGVzIGRpcmVjdG9yeSAoY3JlYXRlZCBieSBhZnRlci1wYWNrLmpzKVxyXG4gICAgICBwYXRoLmpvaW4ocHJvY2Vzcy5yZXNvdXJjZXNQYXRoIHx8ICcnLCAnbW9kdWxlcy9idWlsZC9lbGVjdHJvbicsIGNhdGVnb3J5LCBtb2R1bGVOYW1lKSxcclxuICAgICAgcGF0aC5qb2luKHByb2Nlc3MucmVzb3VyY2VzUGF0aCB8fCAnJywgJ21vZHVsZXMvc3JjL2VsZWN0cm9uJywgY2F0ZWdvcnksIG1vZHVsZU5hbWUpLFxyXG5cclxuICAgICAgLy8gUmVsYXRpdmUgcGF0aHMgZnJvbSBjdXJyZW50IG1vZHVsZVxyXG4gICAgICBwYXRoLmpvaW4oX19kaXJuYW1lLCAnLi4nLCBjYXRlZ29yeSwgbW9kdWxlTmFtZSksXHJcbiAgICAgIHBhdGguam9pbihfX2Rpcm5hbWUsICcuLi8uLicsIGNhdGVnb3J5LCBtb2R1bGVOYW1lKSxcclxuXHJcbiAgICAgIC8vIERpcmVjdCBwYXRocyBmb3Iga25vd24gcHJvYmxlbWF0aWMgbW9kdWxlc1xyXG4gICAgICBjYXRlZ29yeSA9PT0gJ3NlcnZpY2VzL2NvbnZlcnNpb24nICYmIG1vZHVsZU5hbWUgPT09ICdDb252ZXJ0ZXJSZWdpc3RyeS5qcydcclxuICAgICAgICA/IHBhdGguam9pbihhcHBQYXRoLCAnYnVpbGQvZWxlY3Ryb24vc2VydmljZXMvY29udmVyc2lvbi9Db252ZXJ0ZXJSZWdpc3RyeS5qcycpXHJcbiAgICAgICAgOiBudWxsLFxyXG4gICAgICBjYXRlZ29yeSA9PT0gJ3NlcnZpY2VzL2NvbnZlcnNpb24nICYmIG1vZHVsZU5hbWUgPT09ICdDb252ZXJ0ZXJSZWdpc3RyeS5qcydcclxuICAgICAgICA/IHBhdGguam9pbihhcHBQYXRoLCAnc3JjL2VsZWN0cm9uL3NlcnZpY2VzL2NvbnZlcnNpb24vQ29udmVydGVyUmVnaXN0cnkuanMnKVxyXG4gICAgICAgIDogbnVsbCxcclxuXHJcbiAgICAgIC8vIEFzYXItc3BlY2lmaWMgcGF0aHNcclxuICAgICAgcGF0aC5qb2luKGFwcFBhdGgucmVwbGFjZSgnYXBwLmFzYXInLCAnYXBwJyksICdidWlsZC9lbGVjdHJvbicsIGNhdGVnb3J5LCBtb2R1bGVOYW1lKSxcclxuICAgICAgcGF0aC5qb2luKGFwcFBhdGgucmVwbGFjZSgnYXBwLmFzYXInLCAnYXBwJyksICdzcmMvZWxlY3Ryb24nLCBjYXRlZ29yeSwgbW9kdWxlTmFtZSksXHJcblxyXG4gICAgICAvLyBNb2R1bGVzIGZhbGxiYWNrIHdoZW4gcGFja2FnZWRcclxuICAgICAgcGF0aC5qb2luKGFwcFBhdGgucmVwbGFjZSgnYXBwLmFzYXInLCAnbW9kdWxlcycpLCAnYnVpbGQvZWxlY3Ryb24nLCBjYXRlZ29yeSwgbW9kdWxlTmFtZSksXHJcbiAgICAgIHBhdGguam9pbihhcHBQYXRoLnJlcGxhY2UoJ2FwcC5hc2FyJywgJ21vZHVsZXMnKSwgJ3NyYy9lbGVjdHJvbicsIGNhdGVnb3J5LCBtb2R1bGVOYW1lKSxcclxuXHJcbiAgICAgIC8vIEV4dHJlbWUgZmFsbGJhY2sgZm9yIHRoZSBzcGVjaWZpYyBwcm9ibGVtIHBhdGggd2UndmUgc2VlblxyXG4gICAgICBjYXRlZ29yeSA9PT0gJ3NlcnZpY2VzL2NvbnZlcnNpb24nICYmIG1vZHVsZU5hbWUgPT09ICdDb252ZXJ0ZXJSZWdpc3RyeS5qcydcclxuICAgICAgICA/ICdDOlxcXFxVc2Vyc1xcXFxKb3NlcGhcXFxcRG9jdW1lbnRzXFxcXENvZGVcXFxcY29kZXgtbWRcXFxcZGlzdFxcXFx3aW4tdW5wYWNrZWRcXFxccmVzb3VyY2VzXFxcXGFwcC5hc2FyXFxcXGJ1aWxkXFxcXGVsZWN0cm9uXFxcXHNlcnZpY2VzXFxcXGNvbnZlcnNpb25cXFxcQ29udmVydGVyUmVnaXN0cnkuanMnXHJcbiAgICAgICAgOiBudWxsLFxyXG5cclxuICAgICAgLy8gQ2hlY2sgZm9yIHRoZSBleHRlcm5hbCBtb2R1bGVzIGRpcmVjdG9yeSBpbiB2YXJpb3VzIGxvY2F0aW9uc1xyXG4gICAgICBjYXRlZ29yeSA9PT0gJ3NlcnZpY2VzL2NvbnZlcnNpb24nICYmIG1vZHVsZU5hbWUgPT09ICdDb252ZXJ0ZXJSZWdpc3RyeS5qcydcclxuICAgICAgICA/ICdDOlxcXFxVc2Vyc1xcXFxKb3NlcGhcXFxcRG9jdW1lbnRzXFxcXENvZGVcXFxcY29kZXgtbWRcXFxcZGlzdFxcXFx3aW4tdW5wYWNrZWRcXFxccmVzb3VyY2VzXFxcXG1vZHVsZXNcXFxcYnVpbGRcXFxcZWxlY3Ryb25cXFxcc2VydmljZXNcXFxcY29udmVyc2lvblxcXFxDb252ZXJ0ZXJSZWdpc3RyeS5qcydcclxuICAgICAgICA6IG51bGwsXHJcbiAgICBdLmZpbHRlcihCb29sZWFuKTsgLy8gUmVtb3ZlIG51bGwgZW50cmllc1xyXG4gICAgXHJcbiAgICAvLyBGaW5kIGZpcnN0IGV4aXN0aW5nIHBhdGhcclxuICAgIGZvciAoY29uc3Qgc2VhcmNoUGF0aCBvZiBzZWFyY2hQYXRocykge1xyXG4gICAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGV4aXN0cyA9IGZzLmV4aXN0c1N5bmMoc2VhcmNoUGF0aCk7XHJcbiAgICAgICAgaWYgKGV4aXN0cykge1xyXG4gICAgICAgICAgbG9nZ2VyLmxvZyhg4pyFIFtNb2R1bGVSZXNvbHZlcl0gRm91bmQgbW9kdWxlIGF0OiAke3NlYXJjaFBhdGh9YCk7XHJcbiAgICAgICAgICByZXR1cm4gc2VhcmNoUGF0aDtcclxuICAgICAgICB9XHJcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgbG9nZ2VyLndhcm4oYOKaoO+4jyBbTW9kdWxlUmVzb2x2ZXJdIEVycm9yIGNoZWNraW5nIHBhdGggJHtzZWFyY2hQYXRofTogJHtlcnJvci5tZXNzYWdlfWApO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIElmIG5vIHBhdGggZm91bmQsIHJldHVybiB0aGUgbW9zdCBsaWtlbHkgcGF0aCAtIHdpbGwgZmFpbCBidXQgd2l0aCBhIGNsZWFyIGVycm9yXHJcbiAgICBsb2dnZXIud2Fybihg4pqg77iPIFtNb2R1bGVSZXNvbHZlcl0gTm8gZXhpc3RpbmcgbW9kdWxlIGZvdW5kLCByZXR1cm5pbmcgZGVmYXVsdCBwYXRoYCk7XHJcbiAgICByZXR1cm4gcGF0aC5qb2luKGFwcFBhdGgsICdidWlsZC9lbGVjdHJvbicsIGNhdGVnb3J5LCBtb2R1bGVOYW1lKTtcclxuICB9XHJcbiAgXHJcbiAgLyoqXHJcbiAgICogU2FmZWx5IHJlcXVpcmVzIGEgbW9kdWxlIGJ5IHJlc29sdmluZyBpdHMgcGF0aCBmaXJzdFxyXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBtb2R1bGVOYW1lIC0gVGhlIGZpbGVuYW1lIG9mIHRoZSBtb2R1bGUgKGUuZy4gJ0NvbnZlcnRlclJlZ2lzdHJ5LmpzJylcclxuICAgKiBAcGFyYW0ge3N0cmluZ30gY2F0ZWdvcnkgLSBUaGUgY2F0ZWdvcnkgcGF0aCAoZS5nLiAnc2VydmljZXMvY29udmVyc2lvbicpXHJcbiAgICogQHJldHVybnMge2FueX0gVGhlIGxvYWRlZCBtb2R1bGVcclxuICAgKiBAdGhyb3dzIHtFcnJvcn0gSWYgdGhlIG1vZHVsZSBjYW5ub3QgYmUgbG9hZGVkXHJcbiAgICovXHJcbiAgc3RhdGljIHNhZmVSZXF1aXJlKG1vZHVsZU5hbWUsIGNhdGVnb3J5KSB7XHJcbiAgICAvLyBHZXQgbG9nZ2VyIGZvciB2ZXJib3NlIGxvZ2dpbmdcclxuICAgIGxldCBsb2dnZXI7XHJcbiAgICB0cnkge1xyXG4gICAgICBsb2dnZXIgPSByZXF1aXJlKCcuLi91dGlscy9sb2dnZXInKTtcclxuICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgbG9nZ2VyID0ge1xyXG4gICAgICAgIGxvZzogY29uc29sZS5sb2csXHJcbiAgICAgICAgZXJyb3I6IGNvbnNvbGUuZXJyb3IsXHJcbiAgICAgICAgd2FybjogY29uc29sZS53YXJuLFxyXG4gICAgICAgIGRlYnVnOiBjb25zb2xlLmRlYnVnXHJcbiAgICAgIH07XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGNvbnN0IG1vZHVsZVBhdGggPSB0aGlzLnJlc29sdmVNb2R1bGVQYXRoKG1vZHVsZU5hbWUsIGNhdGVnb3J5KTtcclxuICAgIGxvZ2dlci5sb2coYPCflIQgW01vZHVsZVJlc29sdmVyXSBSZXF1aXJpbmcgbW9kdWxlIGZyb206ICR7bW9kdWxlUGF0aH1gKTtcclxuICAgIFxyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3QgbW9kdWxlID0gcmVxdWlyZShtb2R1bGVQYXRoKTtcclxuICAgICAgbG9nZ2VyLmxvZyhg4pyFIFtNb2R1bGVSZXNvbHZlcl0gU3VjY2Vzc2Z1bGx5IGxvYWRlZCBtb2R1bGU6ICR7bW9kdWxlTmFtZX1gKTtcclxuICAgICAgcmV0dXJuIG1vZHVsZS5kZWZhdWx0IHx8IG1vZHVsZTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGxvZ2dlci5lcnJvcihg4p2MIFtNb2R1bGVSZXNvbHZlcl0gRmFpbGVkIHRvIGxvYWQgbW9kdWxlOiAke21vZHVsZU5hbWV9IGZyb20gJHttb2R1bGVQYXRofWApO1xyXG4gICAgICBsb2dnZXIuZXJyb3IoYOKdjCBbTW9kdWxlUmVzb2x2ZXJdIEVycm9yIGRldGFpbHM6ICR7ZXJyb3IubWVzc2FnZX1gKTtcclxuICAgICAgXHJcbiAgICAgIC8vIFRyeSBvbmUgbW9yZSBhcHByb2FjaCAtIGRpcmVjdCByZXF1aXJlXHJcbiAgICAgIHRyeSB7XHJcbiAgICAgICAgaWYgKGNhdGVnb3J5ID09PSAnc2VydmljZXMvY29udmVyc2lvbicgJiYgbW9kdWxlTmFtZSA9PT0gJ0NvbnZlcnRlclJlZ2lzdHJ5LmpzJykge1xyXG4gICAgICAgICAgbG9nZ2VyLmxvZyhg8J+UhCBbTW9kdWxlUmVzb2x2ZXJdIFRyeWluZyBkaXJlY3QgcmVxdWlyZSBmb3IgQ29udmVydGVyUmVnaXN0cnkuanNgKTtcclxuICAgICAgICAgIHJldHVybiByZXF1aXJlKCcuLi9zZXJ2aWNlcy9jb252ZXJzaW9uL0NvbnZlcnRlclJlZ2lzdHJ5LmpzJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9IGNhdGNoIChkaXJlY3RFcnJvcikge1xyXG4gICAgICAgIGxvZ2dlci53YXJuKGDimqDvuI8gW01vZHVsZVJlc29sdmVyXSBEaXJlY3QgcmVxdWlyZSBhbHNvIGZhaWxlZDogJHtkaXJlY3RFcnJvci5tZXNzYWdlfWApO1xyXG4gICAgICB9XHJcbiAgICAgIFxyXG4gICAgICAvLyBSZXRocm93IHRoZSBvcmlnaW5hbCBlcnJvciB3aXRoIG1vcmUgY29udGV4dFxyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYEZhaWxlZCB0byBsb2FkIG1vZHVsZTogJHttb2R1bGVOYW1lfSBmcm9tICR7bW9kdWxlUGF0aH0uIEVycm9yOiAke2Vycm9yLm1lc3NhZ2V9YCk7XHJcbiAgICB9XHJcbiAgfVxyXG4gIFxyXG4gIC8qKlxyXG4gICAqIEdldCBhbGwgdGhlIHNlYXJjaCBwYXRocyBmb3IgYSBtb2R1bGUgd2l0aG91dCBsb2FkaW5nIGl0XHJcbiAgICogQHBhcmFtIHtzdHJpbmd9IG1vZHVsZU5hbWUgLSBUaGUgZmlsZW5hbWUgb2YgdGhlIG1vZHVsZVxyXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBjYXRlZ29yeSAtIFRoZSBjYXRlZ29yeSBwYXRoXHJcbiAgICogQHJldHVybnMge0FycmF5PHN0cmluZz59IEFycmF5IG9mIHBvc3NpYmxlIHBhdGhzXHJcbiAgICovXHJcbiAgc3RhdGljIGdldEFsbFBhdGhzKG1vZHVsZU5hbWUsIGNhdGVnb3J5KSB7XHJcbiAgICBsZXQgYXBwUGF0aDtcclxuICAgIHRyeSB7XHJcbiAgICAgIGFwcFBhdGggPSBhcHAgPyBhcHAuZ2V0QXBwUGF0aCgpIDogcHJvY2Vzcy5jd2QoKTtcclxuICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgYXBwUGF0aCA9IHByb2Nlc3MuY3dkKCk7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIFtcclxuICAgICAgLy8gQnVpbGQgcGF0aHMgKHByZWZlcnJlZClcclxuICAgICAgcGF0aC5qb2luKGFwcFBhdGgsICdidWlsZC9lbGVjdHJvbicsIGNhdGVnb3J5LCBtb2R1bGVOYW1lKSxcclxuXHJcbiAgICAgIC8vIFNvdXJjZSBwYXRoc1xyXG4gICAgICBwYXRoLmpvaW4oYXBwUGF0aCwgJ3NyYy9lbGVjdHJvbicsIGNhdGVnb3J5LCBtb2R1bGVOYW1lKSxcclxuXHJcbiAgICAgIC8vIFJlc291cmNlIHBhdGhzIGZvciBwYWNrYWdlZCBhcHBcclxuICAgICAgcGF0aC5qb2luKHByb2Nlc3MucmVzb3VyY2VzUGF0aCB8fCAnJywgJ2FwcC9idWlsZC9lbGVjdHJvbicsIGNhdGVnb3J5LCBtb2R1bGVOYW1lKSxcclxuICAgICAgcGF0aC5qb2luKHByb2Nlc3MucmVzb3VyY2VzUGF0aCB8fCAnJywgJ2FwcC9zcmMvZWxlY3Ryb24nLCBjYXRlZ29yeSwgbW9kdWxlTmFtZSksXHJcblxyXG4gICAgICAvLyBFeHRlcm5hbCBtb2R1bGVzIGRpcmVjdG9yeSAoY3JlYXRlZCBieSBhZnRlci1wYWNrLmpzKVxyXG4gICAgICBwYXRoLmpvaW4ocHJvY2Vzcy5yZXNvdXJjZXNQYXRoIHx8ICcnLCAnbW9kdWxlcy9idWlsZC9lbGVjdHJvbicsIGNhdGVnb3J5LCBtb2R1bGVOYW1lKSxcclxuICAgICAgcGF0aC5qb2luKHByb2Nlc3MucmVzb3VyY2VzUGF0aCB8fCAnJywgJ21vZHVsZXMvc3JjL2VsZWN0cm9uJywgY2F0ZWdvcnksIG1vZHVsZU5hbWUpLFxyXG5cclxuICAgICAgLy8gUmVsYXRpdmUgcGF0aHMgZnJvbSBjdXJyZW50IG1vZHVsZVxyXG4gICAgICBwYXRoLmpvaW4oX19kaXJuYW1lLCAnLi4nLCBjYXRlZ29yeSwgbW9kdWxlTmFtZSksXHJcbiAgICAgIHBhdGguam9pbihfX2Rpcm5hbWUsICcuLi8uLicsIGNhdGVnb3J5LCBtb2R1bGVOYW1lKSxcclxuXHJcbiAgICAgIC8vIEFzYXItc3BlY2lmaWMgcGF0aHNcclxuICAgICAgcGF0aC5qb2luKGFwcFBhdGgucmVwbGFjZSgnYXBwLmFzYXInLCAnYXBwJyksICdidWlsZC9lbGVjdHJvbicsIGNhdGVnb3J5LCBtb2R1bGVOYW1lKSxcclxuICAgICAgcGF0aC5qb2luKGFwcFBhdGgucmVwbGFjZSgnYXBwLmFzYXInLCAnYXBwJyksICdzcmMvZWxlY3Ryb24nLCBjYXRlZ29yeSwgbW9kdWxlTmFtZSksXHJcblxyXG4gICAgICAvLyBNb2R1bGVzIGZhbGxiYWNrIHdoZW4gcGFja2FnZWRcclxuICAgICAgcGF0aC5qb2luKGFwcFBhdGgucmVwbGFjZSgnYXBwLmFzYXInLCAnbW9kdWxlcycpLCAnYnVpbGQvZWxlY3Ryb24nLCBjYXRlZ29yeSwgbW9kdWxlTmFtZSksXHJcbiAgICAgIHBhdGguam9pbihhcHBQYXRoLnJlcGxhY2UoJ2FwcC5hc2FyJywgJ21vZHVsZXMnKSwgJ3NyYy9lbGVjdHJvbicsIGNhdGVnb3J5LCBtb2R1bGVOYW1lKSxcclxuXHJcbiAgICAgIC8vIEhhcmRjb2RlZCBmYWxsYmFja3MgZm9yIFdpbmRvd3NcclxuICAgICAgY2F0ZWdvcnkgPT09ICdzZXJ2aWNlcy9jb252ZXJzaW9uJyAmJiBtb2R1bGVOYW1lID09PSAnQ29udmVydGVyUmVnaXN0cnkuanMnXHJcbiAgICAgICAgPyAnQzpcXFxcVXNlcnNcXFxcSm9zZXBoXFxcXERvY3VtZW50c1xcXFxDb2RlXFxcXGNvZGV4LW1kXFxcXGRpc3RcXFxcd2luLXVucGFja2VkXFxcXHJlc291cmNlc1xcXFxtb2R1bGVzXFxcXGJ1aWxkXFxcXGVsZWN0cm9uXFxcXHNlcnZpY2VzXFxcXGNvbnZlcnNpb25cXFxcQ29udmVydGVyUmVnaXN0cnkuanMnXHJcbiAgICAgICAgOiBudWxsXHJcbiAgICBdLmZpbHRlcihCb29sZWFuKTtcclxuICB9XHJcbn1cclxuXHJcbm1vZHVsZS5leHBvcnRzID0geyBNb2R1bGVSZXNvbHZlciB9OyJdLCJtYXBwaW5ncyI6Ijs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLE1BQU1BLElBQUksR0FBR0MsT0FBTyxDQUFDLE1BQU0sQ0FBQztBQUM1QixNQUFNQyxFQUFFLEdBQUdELE9BQU8sQ0FBQyxVQUFVLENBQUM7QUFDOUIsTUFBTUUsUUFBUSxHQUFHRixPQUFPLENBQUMsVUFBVSxDQUFDOztBQUVwQztBQUNB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Q0FBQ3VCLElBQUksQ0FBQ0osT0FBTyxDQUFDSyxhQUFhLElBQUksRUFBRSxFQUFFLGtCQUFrQixFQUFFZixRQUFRLEVBQUVELFVBQVUsQ0FBQztJQUVoRjtJQUNBUixJQUFJLENBQUN1QixJQUFJLENBQUNKLE9BQU8sQ0FBQ0ssYUFBYSxJQUFJLEVBQUUsRUFBRSx3QkFBd0IsRUFBRWYsUUFBUSxFQUFFRCxVQUFVLENBQUMsRUFDdEZSLElBQUksQ0FBQ3VCLElBQUksQ0FBQ0osT0FBTyxDQUFDSyxhQUFhLElBQUksRUFBRSxFQUFFLHNCQUFzQixFQUFFZixRQUFRLEVBQUVELFVBQVUsQ0FBQztJQUVwRjtJQUNBUixJQUFJLENBQUN1QixJQUFJLENBQUNFLFNBQVMsRUFBRSxJQUFJLEVBQUVoQixRQUFRLEVBQUVELFVBQVUsQ0FBQyxFQUNoRFIsSUFBSSxDQUFDdUIsSUFBSSxDQUFDRSxTQUFTLEVBQUUsT0FBTyxFQUFFaEIsUUFBUSxFQUFFRCxVQUFVLENBQUM7SUFFbkQ7SUFDQVIsSUFBSSxDQUFDdUIsSUFBSSxDQUFDTixPQUFPLENBQUNTLE9BQU8sQ0FBQyxVQUFVLEVBQUUsS0FBSyxDQUFDLEVBQUUsZ0JBQWdCLEVBQUVqQixRQUFRLEVBQUVELFVBQVUsQ0FBQyxFQUNyRlIsSUFBSSxDQUFDdUIsSUFBSSxDQUFDTixPQUFPLENBQUNTLE9BQU8sQ0FBQyxVQUFVLEVBQUUsS0FBSyxDQUFDLEVBQUUsY0FBYyxFQUFFakIsUUFBUSxFQUFFRCxVQUFVLENBQUM7SUFFbkY7SUFDQVIsSUFBSSxDQUFDdUIsSUFBSSxDQUFDTixPQUFPLENBQUNTLE9BQU8sQ0FBQyxVQUFVLEVBQUUsU0FBUyxDQUFDLEVBQUUsZ0JBQWdCLEVBQUVqQixRQUFRLEVBQUVELFVBQVUsQ0FBQyxFQUN6RlIsSUFBSSxDQUFDdUIsSUFBSSxDQUFDTixPQUFPLENBQUNTLE9BQU8sQ0FBQyxVQUFVLEVBQUUsU0FBUyxDQUFDLEVBQUUsY0FBYyxFQUFFakIsUUFBUSxFQUFFRCxVQUFVLENBQUM7SUFFdkY7SUFDQUMsUUFBUSxLQUFLLHFCQUFxQixJQUFJRCxVQUFVLEtBQUssc0JBQXNCLEdBQ3ZFLG1KQUFtSixHQUNuSixJQUFJLENBQ1QsQ0FBQ21CLE1BQU0sQ0FBQ0MsT0FBTyxDQUFDO0VBQ25CO0FBQ0Y7QUFFQU0sTUFBTSxDQUFDSyxPQUFPLEdBQUc7RUFBRWpDO0FBQWUsQ0FBQyIsImlnbm9yZUxpc3QiOltdfQ==